<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taskflow ‚Äî My Tasks</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>
    <div class="bg-orb orb-3"></div>

    <div class="app-shell">

        <!-- ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ -->
        <aside class="sidebar">
            <div class="brand">
                <div class="brand-icon">‚ú¶</div>
                <span class="brand-name">Taskflow</span>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" data-tab="tasks">
                    <span class="nav-icon">‚óà</span>
                    <span>Tasks</span>
                </button>
                <button class="nav-item" data-tab="stats">
                    <span class="nav-icon">‚óâ</span>
                    <span>Statistics</span>
                </button>
            </nav>

            <div class="sidebar-stats">
                <div class="sstat">
                    <span class="sstat-num" id="sb-total">0</span>
                    <span class="sstat-lbl">Total</span>
                </div>
                <div class="sstat-divider"></div>
                <div class="sstat">
                    <span class="sstat-num accent" id="sb-pending">0</span>
                    <span class="sstat-lbl">Active</span>
                </div>
                <div class="sstat-divider"></div>
                <div class="sstat">
                    <span class="sstat-num green" id="sb-done">0</span>
                    <span class="sstat-lbl">Done</span>
                </div>
            </div>

            <div class="sidebar-footer">
                <div class="completion-ring-wrap">
                    <svg class="completion-ring" viewBox="0 0 56 56">
                        <circle class="ring-bg"   cx="28" cy="28" r="22"/>
                        <circle class="ring-fill" id="ring-fill" cx="28" cy="28" r="22" stroke-dasharray="0 138.23"/>
                    </svg>
                    <span class="ring-label" id="ring-pct">0%</span>
                </div>
                <span class="ring-desc">completion rate</span>
            </div>
        </aside>

        <!-- ‚îÄ‚îÄ Main ‚îÄ‚îÄ -->
        <main class="main-content">

            <!-- TASKS TAB -->
            <section class="tab-panel active" id="tab-tasks">

                <div class="page-header">
                    <div>
                        <h1 class="page-title">My Tasks</h1>
                        <p class="page-sub">Stay organised. Stay focused.</p>
                    </div>
                    <button class="btn-add-trigger" id="toggleAddForm">+ New Task</button>
                </div>

                <!-- Add Task Form -->
                <div class="add-form-wrap" id="addFormWrap">
                    <div class="card form-card">
                        <h3 class="card-title">Create Task</h3>
                        <form id="addTaskForm">
                            <div class="form-row">
                                <input class="input" type="text" id="taskTitle" placeholder="Task title *" required>
                            </div>
                            <div class="form-row">
                                <textarea class="input textarea" id="taskDescription" placeholder="Add a description‚Ä¶" rows="2"></textarea>
                            </div>
                            <div class="form-row form-cols">
                                <select class="input select" id="taskCategory">
                                    <option value="General">üìã General</option>
                                    <option value="Work">üíº Work</option>
                                    <option value="Personal">üè† Personal</option>
                                    <option value="Shopping">üõí Shopping</option>
                                    <option value="Health">‚ù§Ô∏è Health</option>
                                    <option value="Study">üìö Study</option>
                                </select>
                                <select class="input select" id="taskPriority">
                                    <option value="Low">üü¢ Low</option>
                                    <option value="Medium" selected>üü° Medium</option>
                                    <option value="High">üî¥ High</option>
                                </select>
                                <input class="input" type="date" id="taskDueDate">
                            </div>
                            <div class="form-row">
                                <input class="input" type="text" id="taskTags" placeholder="Tags: urgent, review‚Ä¶">
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">Add Task</button>
                                <button type="button" class="btn btn-ghost" id="cancelAdd">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filters-bar">
                    <div class="search-wrap">
                        <span class="search-icon">‚åï</span>
                        <input class="input search-input" type="text" id="searchInput" placeholder="Search tasks‚Ä¶">
                    </div>
                    <select class="input select filter-sel" id="filterCategory">
                        <option value="all">All Categories</option>
                        <option value="General">General</option>
                        <option value="Work">Work</option>
                        <option value="Personal">Personal</option>
                        <option value="Shopping">Shopping</option>
                        <option value="Health">Health</option>
                        <option value="Study">Study</option>
                    </select>
                    <select class="input select filter-sel" id="filterPriority">
                        <option value="all">All Priorities</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                    <select class="input select filter-sel" id="filterStatus">
                        <option value="all">All Tasks</option>
                        <option value="pending">Pending</option>
                        <option value="completed">Completed</option>
                    </select>
                    <select class="input select filter-sel" id="sortBy">
                        <option value="created">Newest First</option>
                        <option value="dueDate">Due Date</option>
                        <option value="priority">Priority</option>
                        <option value="title">A ‚Üí Z</option>
                    </select>
                    <button class="btn btn-ghost btn-sm" id="clearCompleted">Clear Done</button>
                </div>

                <!-- Tasks List -->
                <div id="tasksList" class="tasks-list"></div>

            </section>

            <!-- STATISTICS TAB -->
            <section class="tab-panel" id="tab-stats">

                <div class="page-header">
                    <div>
                        <h1 class="page-title">Statistics</h1>
                        <p class="page-sub">Insights into your productivity.</p>
                    </div>
                </div>

                <div class="kpi-row">
                    <div class="kpi-card">
                        <span class="kpi-icon">‚óà</span>
                        <span class="kpi-num" id="kpi-total">0</span>
                        <span class="kpi-lbl">Total Tasks</span>
                    </div>
                    <div class="kpi-card kpi-green">
                        <span class="kpi-icon">‚úì</span>
                        <span class="kpi-num" id="kpi-done">0</span>
                        <span class="kpi-lbl">Completed</span>
                    </div>
                    <div class="kpi-card kpi-amber">
                        <span class="kpi-icon">‚ó∑</span>
                        <span class="kpi-num" id="kpi-pending">0</span>
                        <span class="kpi-lbl">Pending</span>
                    </div>
                    <div class="kpi-card kpi-red">
                        <span class="kpi-icon">‚ö°</span>
                        <span class="kpi-num" id="kpi-overdue">0</span>
                        <span class="kpi-lbl">Overdue</span>
                    </div>
                    <div class="kpi-card kpi-purple">
                        <span class="kpi-icon">%</span>
                        <span class="kpi-num" id="kpi-rate">0%</span>
                        <span class="kpi-lbl">Completion Rate</span>
                    </div>
                </div>

                <div class="charts-row">
                    <div class="card chart-card">
                        <h3 class="card-title">Task Status</h3>
                        <div class="donut-wrap">
                            <svg class="donut-svg" viewBox="0 0 120 120">
                                <circle class="donut-bg" cx="60" cy="60" r="48"/>
                                <circle class="donut-done" id="donut-done" cx="60" cy="60" r="48" stroke-dasharray="0 301.59" stroke-dashoffset="0"/>
                                <circle class="donut-pending" id="donut-pending" cx="60" cy="60" r="48" stroke-dasharray="0 301.59" stroke-dashoffset="0"/>
                            </svg>
                            <div class="donut-center">
                                <span id="donut-pct">0%</span>
                                <small>done</small>
                            </div>
                        </div>
                        <div class="chart-legend">
                            <span class="legend-dot green"></span><span>Completed</span>
                            <span class="legend-dot amber"></span><span>Pending</span>
                        </div>
                    </div>
                    <div class="card chart-card">
                        <h3 class="card-title">Priority Breakdown</h3>
                        <div class="bar-chart" id="priorityChart"></div>
                    </div>
                    <div class="card chart-card">
                        <h3 class="card-title">Tasks by Category</h3>
                        <div class="bar-chart" id="categoryChart"></div>
                    </div>
                </div>

                <div class="card chart-card-wide">
                    <h3 class="card-title">Task Timeline</h3>
                    <div class="timeline-chart" id="timelineChart"></div>
                    <div class="chart-legend" style="margin-top:12px">
                        <span class="legend-dot green"></span><span>Completed</span>
                        <span class="legend-dot amber"></span><span>Pending</span>
                        <span class="legend-dot red"></span><span>Overdue</span>
                    </div>
                </div>

                <div class="card" style="margin-top:16px;padding:24px 28px">
                    <h3 class="card-title">Top Tags</h3>
                    <div class="tag-cloud" id="tagCloud"><p class="empty-hint">No tags yet</p></div>
                </div>

            </section>
        </main>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         TASK DETAIL DRAWER (subtasks live here)
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="drawerBackdrop" class="drawer-backdrop"></div>
    <aside id="taskDrawer" class="task-drawer">

        <div class="drawer-header">
            <div class="drawer-title-wrap">
                <span id="drawerPriBadge" class="badge badge-medium">Medium</span>
                <h2 id="drawerTitle">Task title</h2>
            </div>
            <button class="close-btn" id="closeDrawer">‚úï</button>
        </div>

        <div class="drawer-body">

            <!-- Meta -->
            <div class="drawer-meta" id="drawerMeta"></div>

            <!-- Description -->
            <p class="drawer-desc" id="drawerDesc"></p>

            <!-- ‚îÄ‚îÄ Subtasks section ‚îÄ‚îÄ -->
            <div class="subtasks-section">
                <div class="subtasks-header">
                    <span class="subtasks-label">Subtasks</span>
                    <!-- progress badge e.g. "3 / 7" -->
                    <span class="subtask-progress" id="subtaskProgress">0 / 0</span>
                </div>

                <!-- progress bar -->
                <div class="subtask-bar-track">
                    <div class="subtask-bar-fill" id="subtaskBarFill" style="width:0%"></div>
                </div>

                <!-- checklist -->
                <ul class="subtask-list" id="subtaskList"></ul>

                <!-- add subtask input -->
                <div class="subtask-add-row">
                    <input class="input subtask-input" type="text" id="subtaskInput"
                           placeholder="Add a subtask‚Ä¶ (press Enter)">
                    <button class="btn btn-primary btn-sm" id="subtaskAddBtn">Add</button>
                </div>
            </div>

        </div>

        <!-- drawer footer: edit / delete task -->
        <div class="drawer-footer">
            <button class="btn btn-ghost" id="drawerEditBtn">Edit Task</button>
            <button class="btn btn-danger" id="drawerDeleteBtn">Delete Task</button>
        </div>
    </aside>

    <!-- ‚îÄ‚îÄ Edit Task Modal ‚îÄ‚îÄ -->
    <div id="editModal" class="modal-backdrop">
        <div class="modal-box">
            <div class="modal-header">
                <h2>Edit Task</h2>
                <button class="close-btn" id="closeModal">‚úï</button>
            </div>
            <form id="editTaskForm">
                <input type="hidden" id="editTaskId">
                <div class="form-row">
                    <input class="input" type="text" id="editTaskTitle" placeholder="Task title *" required>
                </div>
                <div class="form-row">
                    <textarea class="input textarea" id="editTaskDescription" placeholder="Description" rows="3"></textarea>
                </div>
                <div class="form-row form-cols">
                    <select class="input select" id="editTaskCategory">
                        <option value="General">üìã General</option>
                        <option value="Work">üíº Work</option>
                        <option value="Personal">üè† Personal</option>
                        <option value="Shopping">üõí Shopping</option>
                        <option value="Health">‚ù§Ô∏è Health</option>
                        <option value="Study">üìö Study</option>
                    </select>
                    <select class="input select" id="editTaskPriority">
                        <option value="Low">üü¢ Low</option>
                        <option value="Medium">üü° Medium</option>
                        <option value="High">üî¥ High</option>
                    </select>
                    <input class="input" type="date" id="editTaskDueDate">
                </div>
                <div class="form-row">
                    <input class="input" type="text" id="editTaskTags" placeholder="Tags (comma-separated)">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                    <button type="button" class="btn btn-ghost" id="cancelEdit">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>